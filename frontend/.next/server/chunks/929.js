"use strict";exports.id=929,exports.ids=[687,929],exports.modules={82929:(a,b,c)=>{c.r(b),c.d(b,{default:()=>l});var d=c(60687),e=c(91687),f=Object.prototype.hasOwnProperty,g=c(43210),h=c.t(g,2),i=c(94219),j=c(16577);let k="use"in h?g.use:()=>{throw TypeError("SanityLiveStream requires a React version with React.use()")};function l(a){let{query:b,dataset:c,params:h={},perspective:l,projectId:m,stega:n}=a,o=(0,g.useCallback)(a=>(j.Hi.add(a),()=>j.Hi.delete(a)),[]),p=(0,g.useSyncExternalStore)(o,()=>j.sq,()=>null),[q,r]=(0,g.useState)(void 0),s=(0,i.J)(a=>{a.post("loader/query-listen",{projectId:m,dataset:c,perspective:l,query:b,params:h,heartbeat:1e4})}),t=(0,i.J)(d=>{if(function a(b,c){var d,e;if(b===c)return!0;if(b&&c&&(d=b.constructor)===c.constructor){if(d===Date)return b.getTime()===c.getTime();if(d===RegExp)return b.toString()===c.toString();if(d===Array){if((e=b.length)===c.length)for(;e--&&a(b[e],c[e]););return -1===e}if(!d||"object"==typeof b){for(d in e=0,b)if(f.call(b,d)&&++e&&!f.call(c,d)||!(d in c)||!a(b[d],c[d]))return!1;return Object.keys(c).length===e}}return b!=b&&c!=c}({projectId:m,dataset:c,query:b,params:h},{projectId:d.projectId,dataset:d.dataset,query:d.query,params:d.params})){let{result:b,resultSourceMap:c,tags:f}=d,g=n?(0,e.stegaEncodeSourceMap)(b,c,{enabled:!0,studioUrl:"/"}):b;console.groupCollapsed("rendering with server action"),a.children({data:g,sourceMap:c,tags:f||[]}).then(a=>{console.log("setChildren(children)"),r(a)},a=>{console.error("rendering with server action: render children error",a)}).finally(()=>console.groupEnd())}});return(0,g.useEffect)(()=>{if(!p)return;let a=p.on("loader/query-change",t),b=setInterval(()=>s(p),1e4);return()=>{clearInterval(b),a()}},[p]),p&&void 0!==q?(0,d.jsx)(d.Fragment,{children:q}):k(a.initial)}l.displayName="SanityLiveStream"},91687:(a,b,c)=>{c.r(b),c.d(b,{encodeIntoResult:()=>k,stegaEncodeSourceMap:()=>r,stegaEncodeSourceMap$1:()=>s});var d=c(27713);let e=/_key\s*==\s*['"](.*)['"]/;function f(a){if(!Array.isArray(a))throw Error("Path is not an array");return a.reduce((a,b,c)=>{let d=typeof b;if("number"===d)return`${a}[${b}]`;if("string"===d)return`${a}${0===c?"":"."}${b}`;if(("string"==typeof b?e.test(b.trim()):"object"==typeof b&&"_key"in b)&&b._key)return`${a}[_key=="${b._key}"]`;if(Array.isArray(b)){let[c,d]=b;return`${a}[${c}:${d}]`}throw Error(`Unsupported path segment \`${JSON.stringify(b)}\``)},"")}let g={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},h={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function i(a){let b,c=[],d=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;for(;null!==(b=d.exec(a));){if(void 0!==b[1]){let a=b[1].replace(/\\(\\|f|n|r|t|')/g,a=>h[a]);c.push(a);continue}if(void 0!==b[2]){c.push(parseInt(b[2],10));continue}if(void 0!==b[3]){let a=b[3].replace(/\\(\\')/g,a=>h[a]);c.push({_key:a,_index:-1});continue}}return c}function j(a){return a.map(a=>{if("string"==typeof a||"number"==typeof a)return a;if(""!==a._key)return{_key:a._key};if(-1!==a._index)return a._index;throw Error(`invalid segment:${JSON.stringify(a)}`)})}function k(a,b,c){return function a(b,c,e=[]){if(null!==b&&Array.isArray(b))return b.map((b,f)=>{if((0,d.u4)(b)){let d=b._key;if("string"==typeof d)return a(b,c,e.concat({_key:d,_index:f}))}return a(b,c,e.concat(f))});if((0,d.u4)(b)){if("block"===b._type||"span"===b._type){let d={...b};return"block"===b._type?d.children=a(b.children,c,e.concat("children")):"span"===b._type&&(d.text=a(b.text,c,e.concat("text"))),d}return Object.fromEntries(Object.entries(b).map(([b,d])=>[b,a(d,c,e.concat(b))]))}return c(b,e)}(a,(a,d)=>{if("string"!=typeof a)return a;let e=function(a,b){var c;if(!b?.mappings)return;let d=(c=a.map(a=>{if("string"==typeof a||"number"==typeof a)return a;if(-1!==a._index)return a._index;throw Error(`invalid segment:${JSON.stringify(a)}`)}),`$${c.map(a=>"string"==typeof a?`['${a.replace(/[\f\n\r\t'\\]/g,a=>g[a])}']`:"number"==typeof a?`[${a}]`:""!==a._key?`[?(@._key=='${a._key.replace(/['\\]/g,a=>g[a])}')]`:`[${a._index}]`).join("")}`);if(void 0!==b.mappings[d])return{mapping:b.mappings[d],matchedPath:d,pathSuffix:""};let e=Object.entries(b.mappings).filter(([a])=>d.startsWith(a)).sort(([a],[b])=>b.length-a.length);if(0==e.length)return;let[f,h]=e[0],i=d.substring(f.length);return{mapping:h,matchedPath:f,pathSuffix:i}}(d,b);if(!e)return a;let{mapping:f,matchedPath:h}=e;if("value"!==f.type||"documentValue"!==f.source.type)return a;let j=b.documents[f.source.document],k=b.paths[f.source.path],l=i(h);return c({sourcePath:i(k).concat(d.slice(l.length)),sourceDocument:j,resultPath:d,value:a})})}let l="drafts.";function m(a){return a.startsWith(l)}function n(a){return a.startsWith("versions.")}let o=({sourcePath:a,resultPath:b,value:c})=>{if(function(a){return!!/^\d{4}-\d{2}-\d{2}/.test(a)&&!!Date.parse(a)}(c)||function(a){try{new URL(a,a.startsWith("/")?"https://acme.com":void 0)}catch{return!1}return!0}(c))return!1;let d=a.at(-1);return!("slug"===a.at(-2)&&"current"===d||"string"==typeof d&&(d.startsWith("_")||d.endsWith("Id"))||a.some(a=>"meta"===a||"metadata"===a||"openGraph"===a||"seo"===a)||q(a)||q(b)||"string"==typeof d&&p.has(d))},p=new Set(["color","colour","currency","email","format","gid","hex","href","hsl","hsla","icon","id","index","key","language","layout","link","linkAction","locale","lqip","page","path","ref","rgb","rgba","route","secret","slug","status","tag","template","theme","type","textTheme","unit","url","username","variant","website"]);function q(a){return a.some(a=>"string"==typeof a&&null!==a.match(/type/i))}function r(a,b,c){let{filter:g,logger:h,enabled:i}=c;if(!i){let d="config.enabled must be true, don't call this function otherwise";throw h?.error?.(`[@sanity/client]: ${d}`,{result:a,resultSourceMap:b,config:c}),TypeError(d)}if(!b)return h?.error?.("[@sanity/client]: Missing Content Source Map from response body",{result:a,resultSourceMap:b,config:c}),a;if(!c.studioUrl){let d="config.studioUrl must be defined";throw h?.error?.(`[@sanity/client]: ${d}`,{result:a,resultSourceMap:b,config:c}),TypeError(d)}let p=[],q=[],r=k(a,b,({sourcePath:a,sourceDocument:b,resultPath:e,value:i})=>{var k;let r;if(("function"==typeof g?g({sourcePath:a,resultPath:e,filterDefault:o,sourceDocument:b,value:i}):o({sourcePath:a,resultPath:e,value:i}))===!1)return h&&q.push({path:f(j(a)),value:`${i.slice(0,20)}${i.length>20?"...":""}`,length:i.length}),i;h&&p.push({path:f(j(a)),value:`${i.slice(0,20)}${i.length>20?"...":""}`,length:i.length});let{baseUrl:s,workspace:t,tool:u}=("/"!==(r="string"==typeof(k="function"==typeof c.studioUrl?c.studioUrl(b):c.studioUrl)?k:k.baseUrl)&&(r=r.replace(/\/$/,"")),"string"==typeof k?{baseUrl:r}:{...k,baseUrl:r});if(!s)return i;let{_id:v,_type:w,_projectId:x,_dataset:y}=b;return(0,d.C)(i,{origin:"sanity.io",href:function(a){let{baseUrl:b,workspace:c="default",tool:d="default",id:e,type:g,path:h,projectId:i,dataset:k}=a;if(!b)throw Error("baseUrl is required");if(!h)throw Error("path is required");if(!e)throw Error("id is required");if("/"!==b&&b.endsWith("/"))throw Error("baseUrl must not end with a slash");let o="default"===c?void 0:c,p="default"===d?void 0:d,q=n(e)?e.split(".").slice(2).join("."):m(e)?e.slice(l.length):e,r=Array.isArray(h)?f(j(h)):h,s=new URLSearchParams({baseUrl:b,id:q,type:g,path:r});if(o&&s.set("workspace",o),p&&s.set("tool",p),i&&s.set("projectId",i),k&&s.set("dataset",k),m(e)||n(e)){if(n(e)){let a=function(a){if(!n(a))return;let[b,c,...d]=a.split(".");return c}(e);s.set("perspective",a)}}else s.set("perspective","published");let t=["/"===b?"":b];o&&t.push(o);let u=["mode=presentation",`id=${q}`,`type=${g}`,`path=${encodeURIComponent(r)}`];return p&&u.push(`tool=${p}`),t.push("intent","edit",`${u.join(";")}?${s}`),t.join("/")}({baseUrl:s,workspace:t,tool:u,id:v,type:w,path:a,...!c.omitCrossDatasetReferenceData&&{dataset:y,projectId:x}})},!1)});if(h){let a=q.length,b=p.length;if((a||b)&&((h?.groupCollapsed||h.log)?.("[@sanity/client]: Encoding source map into result"),h.log?.(`[@sanity/client]: Paths encoded: ${p.length}, skipped: ${q.length}`)),p.length>0&&(h?.log?.("[@sanity/client]: Table of encoded paths"),(h?.table||h.log)?.(p)),q.length>0){let a=new Set;for(let{path:b}of q)a.add(b.replace(e,"0").replace(/\[\d+\]/g,"[]"));h?.log?.("[@sanity/client]: List of skipped paths",[...a.values()])}(a||b)&&h?.groupEnd?.()}return r}var s=Object.freeze({__proto__:null,stegaEncodeSourceMap:r})}};